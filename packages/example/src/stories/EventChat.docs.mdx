import { ArgsTable, Canvas, Controls, Description, Meta } from '@storybook/addon-docs/blocks';
import EventChat from './EventChat';
import EventChatStories, { Default } from './EventChat.stories';
import ListObserver from './components/ListObserver';

# `useEventChat`: 组件通信 `Hooks`

## 介绍

- 提供名字和回调方法，`Hooks` 会返回一个 `emit`
- 用 `emit` 可以向指定名称发送消息，也可以给事件名提供 `callback` 用于接收消息
- 无论是否是父子层级都能相互通信，不会引发不必要的 `rerender`

<Meta
  component={EventChat}
  of={EventChatStories}
  parameters={{
    layout: 'centered',
    // 可选：补充文档相关参数，确保 autodocs 正常生效
    docs: {
      description: {
        component: '这是 EventChat 组件的详细文档，用于展示 Hooks 特性。',
      },
    },
  }}
  tags={['autodocs']}
  title="useEventChat"
/>

## Table of Contents 目录

<ListObserver />

## 基础使用示例

<Canvas
  additionalActions={[
    {
      title: 'Pub in GitHub',
      onClick: () => {
        window.open(
          'https://github.com/cgfeel/event-chat/blob/main/packages/example/src/module/PubNoLimit.tsx',
          '_blank'
        );
      },
    },
    {
      title: 'Sub in GitHub',
      onClick: () => {
        window.open(
          'https://github.com/cgfeel/event-chat/blob/main/packages/example/src/module/SubNoLimit.tsx',
          '_blank'
        );
      },
    },
  ]}
  of={Default}
  sourceState="none"
/>

## API 参数

<Controls />

> 由于 `Storybook` 限制 `useEventChat` 返回的数据类型，切换上方 `tab` 至 `EventChatResult` 查看

### 参数 `callback`：回调函数（指定 `schema`）

```typescript
type DetailBaseType<Name extends string = string> = {
  __origin: string;
  name: Name;
};

type DetailTypeWithSchema<
  Name extends string = string,
  Schema extends ZodType = ZodType,
> = DetailBaseType<Name> & {
  detail: z.output<Schema>;
};
```

### 参数 `callback`：回调函数（不指定 `schema`）

<style>
  {`
  .category-item > a:first-child {
    float: none;
    left: -18px;
    margin-left: 0;
    position: absolute;
    transform: translateY(-50%);
    top: 50%;
  }
  .docs-story, .demo-wrap {
    background-color: #020917;
  }
  .docs-story > div:first-child {
    padding: 0;
    padding-bottom: 22px;
  }
  .floatingList ul {
    margin: 0;
  }
`}
</style>
